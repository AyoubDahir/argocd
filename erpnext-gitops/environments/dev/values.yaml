erpnext:
  image:
    repository: frappe/erpnext
    tag: v15
    pullPolicy: IfNotPresent

  # Correct site name to match server directory "173.208.208.91"
  jobs:
    createSite:
      enabled: false
    migrate:
      enabled: false
    
  ingress:
    enabled: false

  # Service Configuration (Upstream Service - ClusterIP)
  service:
    type: NodePort
    port: 8000
    externalPort: 30779

  # Persistence
  persistence:
    worker:
      enabled: true
      existingClaim: "erpnext-pvc"
    logs:
      enabled: false
      size: 5Gi
      storageClass: "local-path"

  # Web/Gunicorn Configuration
  web:
    replicaCount: 1
    args:
      - /home/frappe/frappe-bench/env/bin/gunicorn
      - --chdir=/home/frappe/frappe-bench/sites
      - -b=0.0.0.0:8000
      - -w=2
      - -t=120
      - frappe.app:application
      - --preload

  # Worker Configuration
  worker:
    enabled: true

# Global Bitnami Registry Override
global:
  imageRegistry: public.ecr.aws

# Scheduler Configuration
scheduler:
  enabled: true

# Database Mirror
mariadb:
  image:
    registry: public.ecr.aws
    repository: bitnami/mariadb
    tag: 10.6.12-debian-11-r0

redis:
  image:
    registry: public.ecr.aws
    repository: bitnami/redis
    tag: 6.2.12-debian-11-r0

  socketio:
    enabled: true

  dbHost: mariadb
  dbPort: 3306
  dbName: _173_208_208_91 
  
  env:
    - name: FRAPPE_SITE_NAME
      value: "173.208.208.91"
    - name: DB_HOST
      value: "mariadb"
    - name: DB_PORT
      value: "3306"
    - name: REDIS_CACHE
      value: "redis://redis:6379/0"
    - name: REDIS_QUEUE
      value: "redis://redis:6379/1"
    - name: REDIS_SOCKETIO
      value: "redis://redis:6379/2"
