erpnext:
  image:
    repository: frappe/erpnext
    tag: v15
    pullPolicy: IfNotPresent

  # Correct site name to match server directory "173.208.208.91"
  # This is CRITICAL for persistent site access.
  jobs:
    createSite:
      enabled: false  # Disable site creation, we have one
    migrate:
      enabled: false  # Manage migrations manually or via CI
      
  # Define the ingress
  ingress:
    enabled: false # Using NodePort for now per user setup? Or enable ingress? 
    # Current setup uses separate Ingress resource managed by user?
    # Let's keep it simple. Service Type NodePort is easier.

  # Service Configuration
  service:
    type: NodePort
    port: 8000
    externalPort: 30779 # Maps to the NodePort we are using

  # Persistence
  persistence:
    worker:
      enabled: true
      size: 10Gi
      storageClass: "local-path" # Guessing K3s default
    logs:
      enabled: true
      size: 5Gi
      storageClass: "local-path"

  # Worker Configuration
  worker:
    enabled: true
    # Provide env vars if needed
    
  # Scheduler Configuration
  scheduler:
    enabled: true
    
  # SocketIO
  socketio:
    enabled: true

  # Database
  dbHost: mariadb
  dbPort: 3306
  dbName: _173_208_208_91 # This might be the DB name derived from site? 
  # Actually, frappe connects via site_config.json. 
  # We just need to ensure env vars are set correctly.

  # Environment Variables for all pods
  # This is where we inject the site name
  env:
    - name: FRAPPE_SITE_NAME
      value: "173.208.208.91"
    - name: DB_HOST
      value: "mariadb"
    - name: DB_PORT
      value: "3306"
    - name: REDIS_CACHE
      value: "redis://redis:6379/0"
    - name: REDIS_QUEUE
      value: "redis://redis:6379/1"
    - name: REDIS_SOCKETIO
      value: "redis://redis:6379/2"
